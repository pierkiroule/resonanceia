<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>ğŸŒ€ IA RÃ©sonante</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header>
    <h1>ğŸŒ€ IA RÃ©sonante</h1>
    <p>Un espace pour dÃ©poser, Ã©couter, rÃ©sonner. Interface de dÃ©monstration reliÃ©e Ã  Nebius Studio.</p>
  </header>

  <section class="panel" aria-label="Conversation">
    <h3>Conversation</h3>
    <div class="history" id="history"></div>
    <div class="small" id="status">PrÃªt Ã  dialoguer (modÃ¨le google/gemma-2-2b-it).</div>
    <div class="toggle-row" role="group" aria-label="Bascule Nebius ou simulation">
      <span class="small">Mode API</span>
      <button id="modeToggle" class="toggle" type="button" aria-pressed="false" title="Basculer entre MOCK et Nebius">
        <span class="toggle-label">MOCK</span>
        <span class="toggle-handle" aria-hidden="true"></span>
        <span class="toggle-label">NEBIUS</span>
      </button>
      <span class="small" id="dataMode">Mode API: â€”</span>
    </div>
    <textarea id="msg" placeholder="Ã‰cris ce qui te traverse..."></textarea>
    <div class="row">
      <div>
        <label for="temperature">TempÃ©rature</label>
        <input type="number" id="temperature" step="0.1" min="0" max="1" value="0.7" />
      </div>
      <div>
        <label for="top_p">Top P</label>
        <input type="number" id="top_p" step="0.05" min="0" max="1" value="0.9" />
      </div>
      <div>
        <label for="max_tokens">Max tokens</label>
        <input type="number" id="max_tokens" min="32" max="2000" value="256" />
      </div>
    </div>
    <button id="sendBtn">Envoyer</button>
    <button id="resetBtn" style="margin-top:8px; background:#272734;">RÃ©initialiser</button>
  </section>

  <section class="panel" aria-label="Nuage de mots rÃ©sonant">
    <div class="panel-header">
      <div>
        <h3>WordCloud rÃ©sonant</h3>
        <p class="small">Mots regroupÃ©s par pivot, noyau et pÃ©riphÃ©rie (donnÃ©es /api/echo).</p>
        <p class="small">StabilitÃ© â†’ opacitÃ© Â· Delta â†’ taille Â· Force lien â†’ proximitÃ©</p>
      </div>
      <span class="badge" id="metaphorBadge">â€”</span>
    </div>
    <div id="wordcloud-container" class="wordcloud">
      <div class="orbit orbit-pivot" aria-hidden="true"></div>
      <div class="orbit orbit-noyau" aria-hidden="true"></div>
      <div class="orbit orbit-peripherie" aria-hidden="true"></div>
      <div class="placeholder small">En attente des premiers mots...</div>
    </div>
  </section>

  <section class="panel" aria-label="Graph rÃ©sonant">
    <div class="panel-header">
      <div>
        <h3>Graph rÃ©sonant</h3>
        <p class="small">Pivot au centre, noyau en anneau, pÃ©riphÃ©rie orbitant. Force des liens â†’ Ã©paisseur.</p>
      </div>
      <span class="badge" id="graphMode">SVG</span>
    </div>
    <div id="graph-container" class="graph-shell">
      <svg id="resonantGraph" viewBox="0 0 640 420" aria-label="Graphique rÃ©sonant"></svg>
    </div>
  </section>

  <button id="debugToggle" class="ghost-btn" aria-expanded="false">Afficher les dÃ©tails techniques</button>

  <section class="panel debug-section" aria-label="Analyse rÃ©sonante brute">
    <h3>Analyse rÃ©sonante</h3>
    <p class="small">Chaque message est aussi envoyÃ© Ã  l'API locale <code>/api/echo</code> pour extraire le pivot, le noyau et la pÃ©riphÃ©rie.</p>
    <pre id="echoPanel">En attente d'un premier message...</pre>
  </section>

  <section class="panel debug-section" aria-label="ModÃ¨le Nebius">
    <h3>ModÃ¨le Nebius</h3>
    <p class="small" id="nebiusStatus">Nebius non activÃ© â€” mode dÃ©veloppement MOCK</p>
    <pre id="nebiusOutput">RÃ©ponse simulÃ©e en attente...</pre>
    <p class="small">POST https://api.tokenfactory.nebius.com/v1/chat/completions</p>
    <p class="small">model: google/gemma-2-2b-it Â· role: system â†’ psychologue clinicien bienveillant</p>
  </section>

  <script src="./script.js"></script>
</body>
</html>
